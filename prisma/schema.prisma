generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Users {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  cars     Cars[]
  Services Services[]

  joinedAt  DateTime @default(now()) @map("joined_at")
  updatedAt DateTime @updatedAt @map("updated_at")
}

model Cars {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  name    String
  mileage Int

  owner    Users      @relation(fields: [ownerId], references: [id])
  ownerId  String     @map("owner_id") @db.ObjectId
  Services Services[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
}

enum ServicesType {
  Recurrent
  NonRecurrent
}

model Services {
  id              String       @id @default(auto()) @map("_id") @db.ObjectId
  title           String
  date            DateTime
  details         String
  cost            Float
  type            ServicesType
  mileage         Int
  mileageInterval Int

  owner   Users  @relation(fields: [ownerId], references: [id])
  ownerId String @map("owner_id") @db.ObjectId
  car     Cars   @relation(fields: [carId], references: [id])
  carId   String @map("car_id") @db.ObjectId

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
}
